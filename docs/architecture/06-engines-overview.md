
# 06-engines-overview.md — Обзор движков BotPlatform

## 1. Введение
Движки (Engines) — это исполнительные подсистемы BotPlatform.  
Каждый движок отвечает за одну функциональную область:
- получение рыночных данных,
- расчёт сигналов,
- исполнение стратегий,
- отправку ордеров.

Все движки полностью изолированы друг от друга и общаются через Event Bus.

---

## 2. Список движков

### 2.1 Market Data Engine
Задача: получать данные от бирж и публиковать `MarketEvent`.

Функции:
- опрос REST/WS биржи,
- нормализация данных в `MarketSnapshot`,
- публикация `market.snapshot` в EventBus.

Слушает: —
Публикует: `market.snapshot`

---

### 2.2 Signals Engine
Задача: вычислять индикаторы и сигналы.

Функции:
- получение MarketSnapshot,
- запуск модулей из `signals/`,
- генерация SignalSnapshot,
- публикация `signal.snapshot`.

Слушает: `market.snapshot`
Публикует: `signal.snapshot`

---

### 2.3 Strategy Engine
Задача: объединить данные и передать их стратегиям.

Функции:
- сбор данных: MarketSnapshot + SignalSnapshot + PositionSnapshot,
- вызов стратегии,
- получение ActionIntents,
- публикация `strategy.decision`.

Слушает: `signal.snapshot`, `market.snapshot`
Публикует: `strategy.decision`

---

### 2.4 Execution Engine
Задача: превращать намерения стратегий в реальные ордера.

Функции:
- приём ActionIntents,
- формирование OrderIntent,
- вызов Exchange.place_order(),
- публикация событий исполнения.

Слушает: `strategy.decision`
Публикует: `order.submitted`, `order.filled`, `order.rejected`

---

## 3. Взаимодействие движков

```
MarketDataEngine
       │
       ▼
SignalsEngine
       │
       ▼
StrategyEngine
       │
       ▼
ExecutionEngine
```

Каждый движок работает по принципу:
1. Слушает события.
2. Обрабатывает данные.
3. Публикует новые события.

---

## 4. Масштабирование движков

### Горизонтальное масштабирование
- MarketDataEngine: каждый может слушать разные биржи.
- SignalsEngine: можно распределить сигналы по экземплярам.
- StrategyEngine: можно запускать по одной на стратегию.
- ExecutionEngine: можно разделить по пользователям/биржам.

### Вертикальное масштабирование
- увеличение частоты тиков,
- расширение набора сигналов,
- добавление стратегий.

---

## 5. Изоляция логики

Движки **не содержат логики стратегий**.  
Они лишь маршрутизируют данные.

---

## 6. Ошибки и надёжность

Каждый движок публикует `system.error` в Event Bus при ошибках.  
Monitoring-слой слушает эти события и отображает их в UI.

---

## 7. Заключение

Движки BotPlatform — это модульная, изолированная и предсказуемая подсистема, обеспечивающая поток данных:
рынок → сигналы → стратегия → исполнение.
